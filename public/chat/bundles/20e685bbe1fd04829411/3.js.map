{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js","webpack:///./node_modules/matrix-react-sdk/src/utils/MegolmExportEncryption.js"],"names":["ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","_passphrase1","current","value","_passphrase2","setState","errStr","_t","_startExport","onFinished","_unmounted","createRef","state","phase","componentWillUnmount","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","console","error","msg","friendlyText","render","BaseDialog","sdk","disableForm","className","title","onSubmit","_onPassphraseFormSubmit","htmlFor","ref","id","autoFocus","size","disabled","onClick","_onCancelClick","PropTypes","instanceOf","MatrixClient","isRequired","func","c","a","b","d","XMLHttpRequest","open","responseType","onload","g","response","onerror","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","self","global","navigator","test","userAgent","HTMLAnchorElement","prototype","h","i","URL","webkitURL","j","createElement","name","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","msSaveOrOpenBlob","autoBom","warn","body","innerText","HTMLElement","safari","FileReader","onloadend","result","replace","readAsDataURL","l","m","module","exports","TextEncoder","TextEncodingUtf8","TextDecoder","subtleCrypto","crypto","subtle","webkitSubtle","friendlyError","Error","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","fileStr","decode","Uint8Array","lineStart","lineEnd","indexOf","line","slice","trim","HEADER_LINE","dataStart","undefined","dataEnd","base64","latin1String","atob","uint8Array","length","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","aesProm","hmacProm","all","String","fromCharCode","apply","btoa"],"mappings":"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","file":"bundles/20e685bbe1fd04829411/3.js","sourceRoot":""}